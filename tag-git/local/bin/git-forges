#!/usr/bin/env python3

import subprocess
import webbrowser


def get_remote_urls() -> set[str]:
    process = subprocess.run(
        ["git", "remote", "-v"],
        capture_output=True,
        check=True,
    )
    lines = process.stdout.decode().strip().split("\n")
    urls = {line.split()[1] for line in lines}
    return urls


def convert_remote_url_to_forge_url(url: str) -> str:
    url = url.removeprefix("https://")
    url = url.removeprefix("git@")
    url = url.removesuffix(".git")
    url = url.replace(":", "/")
    return f"https://{url}"


def browse_forges() -> None:
    remote_urls = get_remote_urls()
    forge_urls = {convert_remote_url_to_forge_url(url) for url in remote_urls}
    for url in forge_urls:
        print(url)
        webbrowser.open(url)


if __name__ == "__main__":
    browse_forges()
