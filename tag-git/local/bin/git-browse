#!/usr/bin/env bash

set -eu

transform_url() {
  url="${1#https://}"  # Remove https:// prefix
  url="${url#git\@}"   # Remove git@ prefix
  url="${url%\.git}"   # Remove .git suffix
  url="${url/://}"     # Replace : with / in SSH URLs
  url="https://$url"   # Add https:// prefix
  echo "$url"
}

open_url() {
  if [[ "$OSTYPE" == darwin* ]]; then
    open "$url"
  else
    xdg-open "$url"
  fi
}

for url in $(git remote get-url --all --push "${1:-origin}"); do
  url="$(transform_url "$url")"
  echo "$url"
  open_url "$url"
done
