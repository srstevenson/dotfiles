#!/usr/bin/env bash

set -eo pipefail

if [[ -n "$KITTY_PID" ]]; then
  kill -SIGUSR1 "$KITTY_PID"
fi

tmux source-file ~/.config/tmux/tmux.conf &>/dev/null

for pane in $(tmux list-panes -a -F "#{pane_id}"); do
  command=$(tmux list-panes -F "#{pane_current_command}" -t "$pane")
  if [[ "$command" == "hx" ]]; then
    tmux send-keys -t "$pane" Escape Enter ":config-reload" Enter
  fi
done
